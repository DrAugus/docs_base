import{k as W,n as se,l as F,C as E,D as U,E as V,h as Q}from"./utils.I4CLDPKf.js";import{p as ne}from"./wishInfo.Dj9xIe_0.js";import"./zh.bQ1W1E25.js";import{d as ae,p as g,v as re,x as ie,c as l,o,j as s,a as le,F as m,B as p,N as f,t as u,k as r,n as A,P as oe,_ as Y,r as de}from"./framework.BZf_BKPf.js";const ce={class:"hide-on-small-only"},ue={style:{textAlign:"center"}},me={class:"timeline-month"},he={class:"timeline-month-text"},fe={class:"timeline-day"},ve={class:"timeline-today-line-pos-text"},ge={class:"timeline-wish-event-weapon"},pe={class:"event-img"},_e=["src"],ye={class:"left-align timeline-character-text sticky text-shadow-weapon"},we={class:"timeline-wish-event-character"},Ae={class:"event-img responsive-img lazy"},xe=["src"],be={class:"timeline-day-index"},Ce={class:"timeline-week-index"},h=40,Ee=ae({__name:"Timeline",props:{WISH:{},CHARACTER:{},GAME_NAME:{}},setup(N){W.locale("zh");const _=N,c=se(_.GAME_NAME),x=g(null),b=g(null),T=async()=>{await oe(),x.value&&b.value&&(x.value.scrollLeft=b.value.offsetLeft-window.innerWidth/2)};let k=-1,$=g("");const y=ne(_.WISH),Z=W(),R=y.firstDay,w=y.events[F.Characters],v=y.events[F.Weapons],q=w.length,J=v.length,K=y.dates,X=y.monthList,S=(Math.abs(R.diff(Z,"day",!0))+1)*(h+1)+"px",I=R;let M=g([]),D=g([]),H=g([]);re(async()=>{for(let e=0;e<q;++e){const n=E(w[e].start).subtract(0,"minute");M.value.push(n.diff(I,"day",!0))}for(let e=0;e<J;++e){const n=E(v[e].start).subtract(0,"minute");D.value.push(n.diff(I,"day",!0));let t=v[e].image;H.value.push(Array.isArray(t)?t.length:1)}k=setInterval(()=>{$.value=W().format("HH:mm:ss")},1e3),T()}),ie(()=>{k&&clearInterval(k)});function L(e,n){return e==n?0:E(n).subtract(0,"minute").diff(E(e).subtract(0,"minute"),"hour",!0)<1?1:-1}function C(e,n){const t=e.length;if(!t)return"";let a="";if(n===0)a+="rounded-l-xl ";else if(n===t-1)a+="rounded-r-xl ";else{let d=L(e[n].end,e[n+1].start);d===1?a+="border-r-4 border-white ":d===-1&&(a+="rounded-r-xl ");let i=L(e[n-1].end,e[n].start);i===1?a+="border-r-4 border-white ":i===-1&&(a+="rounded-l-xl ")}return a.includes("rounded-r-xl")&&(a=a.replace("border-r-4 border-white ","")),a}function P(e){e.target.src=`/image/${c}/wish/_1.jpg`}function j(e,n){var d;let t=H.value[e],a="";return t==2&&(a=`calc((var(--event-height) + var(--event-height-dur)) * ${n})`),{width:((d=v[e])==null?void 0:d.duration)*(h+1)+"px",left:(D.value[e]+1)*(h+1)+"px",height:"var(--event-height)",marginTop:a}}function ee(e,n){var d;let t=H.value[e];t||(t=1);let a=`calc((var(--event-height) + var(--event-height-dur)) * ${t-1+n})`;return{width:((d=w[e])==null?void 0:d.duration)*(h+1)+"px",left:(M.value[e]+1)*(h+1)+"px",marginTop:a}}function te(e){return Array.isArray(e)?e:[e]}return(e,n)=>(o(),l(m,null,[s("div",ce,[s("p",ue,[n[1]||(n[1]=le(" 也许有未实装、未确定的虚假信息 ")),s("a",{onClick:n[0]||(n[0]=t=>T())},"回到当前时间")]),s("div",{class:"timeline-scroll-x",ref_key:"setNowPos",ref:x},[s("div",me,[(o(!0),l(m,null,p(r(X),(t,a)=>(o(),l("div",null,[s("div",{style:f({width:(h+1)*t[1].total+"px"})},[s("span",he,u(t[0]),1)],4)]))),256))]),s("div",fe,[s("div",{style:f(S?{left:S}:""),class:"timeline-today-line-pos",ref_key:"findNowPos",ref:b},[s("div",ve,u(r($)),1)],4),s("div",ge,[(o(!0),l(m,null,p(e.WISH.weapons,(t,a)=>(o(),l("div",null,[(o(!0),l(m,null,p(te(t.image),(d,i)=>(o(),l("div",null,[s("div",{class:A(["card event-item weapon",[C(r(v),a)]]),style:f(j(a,i))},[s("div",{class:A(["card-image waves-effect waves-block waves-light",[C(r(v),a)]]),style:{height:"100%"}},[s("div",pe,[s("img",{src:`/image/${r(c)}/wish/${r(U)(t.name,d)}`,onError:P,alt:""},null,40,_e)]),s("span",ye,u(r(V)("",e.GAME_NAME,i+1)),1)],2)],6)]))),256))]))),256))]),s("div",we,[(o(!0),l(m,null,p(e.WISH.characters,(t,a)=>(o(),l("div",null,[(o(!0),l(m,null,p(t.name,(d,i)=>{var B,G,O,z;return o(),l("div",null,[s("div",{class:A(["card event-item",["ele-"+((G=(B=e.CHARACTER[t.wish5star[i]])==null?void 0:B.ele)==null?void 0:G.id),C(r(w),a)]]),style:f(ee(a,i))},[s("div",{class:A(["card-image waves-effect waves-block waves-light",[C(r(w),a)]]),style:{height:"100%"}},[s("div",Ae,[s("img",{src:`/image/${r(c)}/wish/${r(U)(t.name[i],t.image[i])}`,onError:P,alt:""},null,40,xe)]),s("span",{class:A(["left-align timeline-character-text sticky","ele-text-shadow-"+((z=(O=e.CHARACTER[t.wish5star[i]])==null?void 0:O.ele)==null?void 0:z.id)])},u(r(Q)(t.wishName[i])+r(V)("活动x",e.GAME_NAME)+r(Q)(e.CHARACTER[t.wish5star[i]].prefix+"·"+e.CHARACTER[t.wish5star[i]].name)),3)],2)],6)])}),256))]))),256))]),(o(!0),l(m,null,p(r(K),(t,a)=>(o(),l("div",{style:f({marginLeft:h}),class:"timeline-wrapper"},[s("span",be,u(t[0]),1),s("span",Ce,u(t[1]),1)],4))),256))])],512)]),n[2]||(n[2]=s("div",{class:"hide-on-large-only"},null,-1))],64))}}),Le=Y(Ee,[["__scopeId","data-v-0047352f"]]),Ne={data(){return{}},props:{style:Object,name:"",text:"",tagline:"",textColor:""},components:{}},Te={class:"container"},ke={class:"title"},He={class:"sub-title"},We={class:"section-b"};function $e(N,_,c,x,b,T){return o(),l("div",Te,[s("div",{class:"section-a",style:f(c.style)},[_[0]||(_[0]=s("div",{class:"background"},null,-1)),s("div",ke,u(c.name),1),s("div",He,u(c.text),1),s("div",{class:"tagline",style:f({color:c.textColor})},u(c.tagline),5)],4),s("div",We,[de(N.$slots,"default",{},void 0,!0)])])}const Pe=Y(Ne,[["render",$e],["__scopeId","data-v-4499daee"]]);export{Pe as A,Le as T};
